<project name="goobi-viewer-desktop" default="installer">

	<property name="version" value="1.2-SNAPSHOT" />
	<property name="installer-name" value="Goobi_viewer_Desktop_Client" />
	<property name="nsisant-path" value="lib-build/nsisant-1.3.jar" />
	<property name="nsis-path" value="/usr/bin/" />
	<property name="product-path" value="out/Goobi_viewer_Desktop_Client-win32-x64" />
	<property name="output-dir" value="out" />
	<property name="installer-icon" value="assets/icons/app_32.ico" />

	
	<taskdef name="nsis" classname="com.danielreese.nsisant.Task" classpath="${nsisant-path}" />
	
	<target name="installer" description="Build installer for intranda" depends="make">
		<echo message="Building NSIS installer..." />
		<nsis script="setup.nsi" path="${nsis-path}" verbosity="4" noconfig="no">
			<define name="PRODUCTPATH" value="${product-path}/*" />
			<define name="VERSION" value="${version}" />
			<define name="PATH_OUTFILE" value="${output-dir}/${installer-name}-${version}.exe" />
			<define name="MUI_ICON" value="${installer-icon}" />
		</nsis>
	</target>
	
	<target name="npm" description="Install npm dependencies">
		<exec executable="npm">
			<arg value="install"/>
		</exec>
	</target>
	
	<target name="make" description="Create product files" depends="npm">
			<exec executable="npm">
				<arg value="run"/>
				<arg value="make"/>
			</exec>
		</target>

</project>